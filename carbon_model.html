<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>carbon_model.rb</title>
  <link rel="stylesheet" href="http://jashkenas.github.com/docco/resources/docco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <table cellspacing=0 cellpadding=0>
  <thead>
    <tr>
      <th class=docs><h1>carbon_model.rb</h1></th>
      <th class=code></th>
    </tr>
  </thead>
  <tbody>
    <tr id='section-1'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-1">#</a>
        </div>
        <p> Copyright Â© 2010 Brighter Planet.
 See LICENSE for details.
 Contact Brighter Planet for dual-license arrangements.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-2'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-2">#</a>
        </div>
        <h1>Meeting carbon model</h1>

<p> This model is used by <a href="http://brighterplanet.com">Brighter Planet</a>&rsquo;s carbon emission <a href="http://carbon.brighterplanet.com">web service</a> to estimate the <strong>greenhouse gas emissions of a meeting</strong> (e.g. a conference).</p>

<h4>Timeframe and date</h4>

<p> The model estimates the emissions that occur during a particular <code>timeframe</code>. To do this it needs to know the meeting&rsquo;s <code>date</code>. For example, if the <code>timeframe</code> is January 2010, a meeting that occurred on January 11 2010 will have emissions but a meeting that occurred on Febraury 1 2010 will not.</p>

<h4>Calculations</h4>

<p> The final estimate is the result of the <strong>calculations</strong> detailed below. These calculations are performed in reverse order, starting with the last calculation listed and finishing with the <code>emission</code> calculation. Each calculation is named according to the value it returns.</p>

<h4>Methods</h4>

<p> To accomodate varying client input, each calculation may have one or more <strong>methods</strong>. These are listed under each calculation in order from most to least preferred. Each method is named according to the values it requires. If any of these values is not available the method will be ignored. If all the methods for a calculation are ignored, the calculation will not return a value. &ldquo;Default&rdquo; methods do not require any values, and so a calculation with a default method will always return a value.</p>

<h4>Standard compliance</h4>

<p> Each method lists any established calculation standards with which it <strong>complies</strong>. When compliance with a standard is requested, all methods that do not comply with that standard are ignored. This means that any values a particular method requires will have been calculated using a compliant method, because those are the only methods available. If any value did not have a compliant method in its calculation then it would be undefined, and the current method would have been ignored.</p>

<h4>Collaboration</h4>

<p> Contributions to this carbon model are actively encouraged and warmly welcomed. This library includes a comprehensive test suite to ensure that your changes do not cause regressions. All changes should include test coverage for new functionality. Please see <a href="http://github.com/brighterplanet/sniff#readme">sniff</a>, our emitter testing framework, for more information.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-3'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-3">#</a>
        </div>
        <h2>Emission calculation</h2>

<p> Returns the <code>emission</code> estimate (<em>kg CO<sub>2</sub>e</em>).
 This is the total emission produced by the meeting venue.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-4'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-4">#</a>
        </div>
        <h3>Emission from duration, area, and emission factor</h3>

<p> <strong>Complies:</strong> GHG Protocol, ISO 14064-1, Climate Registry Protocol</p>

<p> Multiplies <code>area</code> (<em>square m</em>) by <code>duration</code> (<em>hours</em>) and the <code>emission factor</code> (<em>kg CO<sub>2</sub>e / square m hour</em>) to give <em>kg CO<sub>2</sub>e</em>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-5'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-5">#</a>
        </div>
        <h3>Default emission</h3>

<p> <strong>Complies:</strong></p>

<p> Displays an error if the previous method fails.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-6'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-6">#</a>
        </div>
        <h2>Emission factor calculation</h2>

<p> Returns the <code>emission factor</code> (*lbs CO<sub>2</sub>e / square m hour).</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-7'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-7">#</a>
        </div>
        <h3>Emission factor from fuel intensities and eGRID subregion</h3>

<p> <strong>Complies:</strong> GHG Protocol, ISO 14064-1, Climate Registry Protocol</p>

<ul>
<li>Looks up the <a href="http://data.brighterplanet.com/fuels">natural gas</a> emission factor (<em>kg CO<sub>2</sub>e / cubic m</em>)</li>
<li>Looks up the <a href="http://data.brighterplanet.com/fuels">fuel oil</a> emission factor (<em>kg CO<sub>2</sub>e / l</em>)</li>
<li>Looks up the <a href="http://data.brighterplanet.com/egrid_subregions">eGRID subregion</a> electricity emission factor</li>
<li>Divides the natural gas emission factor (<em>kg CO<sub>2</sub>e / cubic m</em>) by the natural gas energy content (38,339,000 <em>J / cubic m</em>) to give an energy-based natural gas emission factor (<em>kg CO<sub>2</sub>e / J</em>)</li>
<li>Divides the fuel oil emission factor (<em>kg CO<sub>2</sub>e / l</em>) by the fuel oil energy content (38,655,000 <em>J / l</em>) to give an energy-based fuel oil emission factor (<em>kg CO<sub>2</sub>e / J</em>)</li>
<li>Divides the energy-based natural gas emission factor by 0.817 and the energy-based fuel oil emission factor by 0.846, adds these together and divides by 2, and divides by 0.95. This gives a district heat emission factor (<em>kg CO<sub>2</sub>e / J</em>) based on the assumption that district heat is produced by 50% natural gas and 50% fuel oil, natural gas boilers are 81.7% efficient, fuel oil boilers are 84.6% efficient, and transmission losses are 5%.</li>
<li>Multiplies <code>natural gas intensity</code> by the natural gas emission factor, <code>fuel oil intensity</code> by the fuel oil emission factor, <code>electricity intensity</code> by the electricity emission factor, and <code>district heat intensity</code> by the district heat emission factor</li>
<li>Adds these together</li>
</ul>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-8'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-8">#</a>
        </div>
        <h2>Natural gas intensity calculation</h2>

<p> Returns the meeting venue&rsquo;s <code>natural gas intensity</code> (<em>cubic m / square m hour</em>).</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-9'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-9">#</a>
        </div>
        <h3>From census division</h3>

<p> <strong>Complies:</strong> GHG Protocol, ISO 14064-1, Climate Registry Protocol</p>

<p> Looks up the <a href="http://data.brighterplanet.com/census_divisions">census division</a> meeting building <code>natural gas intensity</code> (<em>cubic m / square m hour</em>).</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-10'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-10">#</a>
        </div>
        <h3>Default natural gas intensity</h3>

<p> <strong>Complies:</strong> GHG Protocol, ISO 14064-1, Climate Registry Protocol</p>

<p> Uses the U.S. average <code>natural gas intensity</code> (<em>cubic m / square m hour</em>).</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-11'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-11">#</a>
        </div>
        <h2>Fuel oil intensity calculation</h2>

<p> Returns the meeting venue&rsquo;s <code>fuel oil intensity</code> (<em>l / square m hour</em>).</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-12'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-12">#</a>
        </div>
        <h3>Fuel oil intensity from census division</h3>

<p> <strong>Complies:</strong> GHG Protocol, ISO 14064-1, Climate Registry Protocol</p>

<p> Looks up the <a href="http://data.brighterplanet.com/census_divisions">census division</a> meeting building <code>fuel oil intensity</code> (<em>l / square m hour</em>).</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-13'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-13">#</a>
        </div>
        <h3>Default fuel oil intensity</h3>

<p> <strong>Complies:</strong> GHG Protocol, ISO 14064-1, Climate Registry Protocol</p>

<p> Uses the U.S. average <code>fuel oil intensity</code> (<em>l / square m hour</em>).</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-14'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-14">#</a>
        </div>
        <h2>Electricity intensity calculation</h2>

<p> Returns the meeting venue&rsquo;s <code>electricity intensity</code> (<em>kWh / square m hour</em>).</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-15'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-15">#</a>
        </div>
        <h3>Electricity intensity from census division and eGRID region</h3>

<p> <strong>Complies:</strong> GHG Protocol, ISO 14064-1, Climate Registry Protocol</p>

<ul>
<li>Looks up the <a href="http://data.brighterplanet.com/census_divisions">census division</a> meeting building <code>electricity intensity</code> (<em>kWh / square m hour</em>)</li>
<li>Looks up the <a href="http://data.brighterplanet.com/egrid_regions">eGRID region</a> loss factor</li>
<li>Divides the <code>electricity intensity</code> by 1 &ndash; the loss factor to account for electricity transmission and distribution losses</li>
</ul>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-16'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-16">#</a>
        </div>
        <h3>Electricity intensity from eGRID region</h3>

<p> <strong>Complies:</strong> GHG Protocol, ISO 14064-1, Climate Registry Protocol</p>

<ul>
<li>Uses the U.S. average meeting building <code>electricity intensity</code> (<em>kWh / square m hour</em>)</li>
<li>Looks up the <a href="http://data.brighterplanet.com/egrid_regions">eGRID region</a> loss factor</li>
<li>Divides the <code>electricity intensity</code> by (1 &ndash; the loss factor) to account for electricity transmission and distribution losses</li>
</ul>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-17'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-17">#</a>
        </div>
        <h2>District heat intensity calculation</h2>

<p> Returns the meeting venue&rsquo;s <code>district heat intensity</code> (<em>J / square m hour</em>)</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-18'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-18">#</a>
        </div>
        <h3>District heat intensity from census division</h3>

<p> <strong>Complies:</strong> GHG Protocol, ISO 14064-1, Climate Registry Protocol</p>

<p> Looks up the <a href="http://data.brighterplanet.com/census_divisions">census division</a> meeting building <code>district heat intensity</code>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-19'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-19">#</a>
        </div>
        <h3>Default district heat intensity</h3>

<p> <strong>Complies:</strong> GHG Protocol, ISO 14064-1, Climate Registry Protocol</p>

<p> Uses the U.S. average.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-20'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-20">#</a>
        </div>
        <h2>eGRID region calculation</h2>

<p> Returns the meeting venue&rsquo;s <a href="http://data.brighterplanet.com/egrid_regions">eGRID region</a>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-21'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-21">#</a>
        </div>
        <h3>eGRID region from eGRID subregion</h3>

<p> <strong>Complies:</strong> GHG Protocol, ISO 14064-1, Climate Registry Protocol</p>

<p> Looks up the <a href="http://data.brighterplanet.com/egrid_subregions">eGRID subregion</a> <code>eGRID region</code>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-22'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-22">#</a>
        </div>
        <h2>eGRID subregion calculation</h2>

<p> Returns the meeting venue&rsquo;s <a href="http://data.brighterplanet.com/egrid_subregions">eGRID subregion</a>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-23'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-23">#</a>
        </div>
        <h3>eGRID subregion from zip code</h3>

<p> <strong>Complies:</strong> GHG Protocol, ISO 14064-1, Climate Registry Protocol</p>

<p> Looks up the <a href="http://data.brighterplanet.com/zip_codes">zip code</a> <code>eGRID subregion</code>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-24'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-24">#</a>
        </div>
        <h3>Default eGRID subregion</h3>

<p> <strong>Complies:</strong> GHG Protocol, ISO 14064-1, Climate Registry Protocol</p>

<p> Uses an artificial eGRID subregion that represents the U.S. average.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-25'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-25">#</a>
        </div>
        <h2>Census division calculation</h2>

<p> Returns the meeting venue&rsquo;s <a href="http://data.brighterplanet.com/census_divisions">census division</a>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-26'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-26">#</a>
        </div>
        <h3>Census division from state</h3>

<p> <strong>Complies:</strong> GHG Protocol, ISO 14064-1, Climate Registry Protocol</p>

<p> Looks up the <a href="http://data.brighterplanet.com/states">state</a> <code>census division</code>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-27'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-27">#</a>
        </div>
        <h2>State calculation</h2>

<p> Returns the meeting venue&rsquo;s <a href="http://data.brighterplanet.com/states">state</a>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-28'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-28">#</a>
        </div>
        <h3>State from zip code</h3>

<p> <strong>Complies:</strong> GHG Protocol, ISO 14064-1, Climate Registry Protocol</p>

<p> Looks up the <a href="http://data.brighterplanet.com/zip_codes">zip code</a> <code>state</code>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-29'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-29">#</a>
        </div>
        <h2>Zip code calculation</h2>

<p> Returns the meeting venue&rsquo;s <a href="http://data.brighterplanet.com/zip_codes">zip code</a>.</p>

<h3>Zip code from client input</h3>

<p> <strong>Complies:</strong> All</p>

<p> Uses the client-input <a href="http://data.brighterplanet.com/zip_codes">zip code</a>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-30'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-30">#</a>
        </div>
        <h2>Area calculation</h2>

<p> Returns the meeting venue&rsquo;s <code>area</code> (<em>square m</em>).</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-31'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-31">#</a>
        </div>
        <h3>Area from client input</h3>

<p> <strong>Complies:</strong> All</p>

<p> Uses the client-input <code>area</code> (<em>square m</em>).</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-32'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-32">#</a>
        </div>
        <h3>Default area</h3>

<p> <strong>Complies:</strong> GHG Protocol, ISO 14064-1, Climate Registry Protocol</p>

<p> Uses a default <code>area</code> of 1,184.5 <em>square m</em>.
 This is the median size of buildings in the <a href="http://www.eia.doe.gov/emeu/cbecs/">EIA Commercial Building Energy Consumption Survey</a>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-33'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-33">#</a>
        </div>
        <h2>Duration calculation</h2>

<p> Returns the meeting&rsquo;s <code>duration</code> (hours).</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-34'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-34">#</a>
        </div>
        <h3>Duration from client input</h3>

<p> <strong>Complies:</strong> All</p>

<p> Uses the client-input <code>duration</code> (<em>hours</em>).</p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-35'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-35">#</a>
        </div>
        <h3>Default duration</h3>

<p> <strong>Complies:</strong> GHG Protocol, ISO 14064-1, Climate Registry Protocol</p>

<p> Uses a default <code>duration</code> of 8 <em>hours</em>.</p>

      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    </table>
</div>
</body>
